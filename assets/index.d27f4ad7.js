import{g as J,j as ne,k as L,l as W,o as i,c as r,a as n,m as R,v as le,F as S,r as V,t as m,n as f,q as j,s as z,x as u,y as k,z as E,d as N,A as X,B as ie,C as re,D as oe,E as ue,G as w,H as de,i as _,I as G,b as K,w as O,e as ce}from"./entry.7f94b037.js";import{u as ge,a as _e,_ as fe}from"./loader.34f89b6c.js";const he=n("span",{class:"content__info"}," Найти персонажа: ",-1),me=["onSubmit"],ve={class:"form__block"},ke=n("legend",{class:"form__legend"},"Имя",-1),ye={class:"form__label"},be={key:0,class:"name__helpers"},Ce=["onClick"],Pe=n("div",{class:"animation"},null,-1),xe={class:"form__block"},Le=n("legend",{class:"form__legend"},"Статус",-1),Se={class:"form__label form__label--select"},Te=n("option",{value:"alive"},"Жив",-1),pe=n("option",{value:"dead"},"Мёртв",-1),we=n("option",{value:"unknown"},"Неизвестно",-1),Fe=[Te,pe,we],Ve={class:"form__block"},Ne=n("legend",{class:"form__legend"},"Пол",-1),Be={class:"form__label form__label--select"},Me=n("option",{value:"male"},"Мужской",-1),He=n("option",{value:"female"},"Женский",-1),qe=n("option",{value:"genderless"},"Не имеет пола",-1),Re=n("option",{value:"unknown"},"Неизвестно",-1),Ke=[Me,He,qe,Re],Ae={class:"btn__wrapper"},Ie=n("button",{class:"__submit button button--primary",type:"submit"},"Применить",-1),Ue=["onClick"],De=J({__name:"BaseFilter",props:{helpers:{type:Array,required:!0}},emits:["loadFilteredCharacters","clearFilters","filterByName"],setup(l,{emit:s}){const e=l,o=ne({name:"",status:"",gender:""}),d=L(!1);W(()=>e.helpers,()=>{e.helpers.length>0&&(d.value=!0)});const a=()=>{s("filterByName",o.name)},t=y=>{o.name=y,d.value=!1},g=()=>{d.value=!1,s("loadFilteredCharacters",o)},P=()=>{o.name="",o.status="",o.gender="",s("clearFilters")};return(y,v)=>(i(),r(S,null,[he,n("form",{class:"__form form",action:"#",method:"get",onSubmit:z(g,["prevent"])},[n("fieldset",ve,[ke,n("label",ye,[R(n("input",{onInput:a,class:"form__select",name:"category","onUpdate:modelValue":v[0]||(v[0]=h=>o.name=h)},null,544),[[le,o.name]]),d.value?(i(),r("ul",be,[(i(!0),r(S,null,V(l.helpers,h=>(i(),r("li",{onClick:A=>t(h),key:h},m(h),9,Ce))),128))])):f("",!0),Pe])]),n("fieldset",xe,[Le,n("label",Se,[R(n("select",{class:"form__select",name:"category","onUpdate:modelValue":v[1]||(v[1]=h=>o.status=h)},Fe,512),[[j,o.status]])])]),n("fieldset",Ve,[Ne,n("label",Be,[R(n("select",{class:"form__select",name:"category","onUpdate:modelValue":v[2]||(v[2]=h=>o.gender=h)},Ke,512),[[j,o.gender]])])]),n("div",Ae,[Ie,n("button",{class:"__reset button button--primary",type:"button",onClick:z(P,["prevent"])},"Сбросить",8,Ue)])],40,me)],64))}});var je=(l,s)=>{const e=l.__vccOpts||l;for(const[o,d]of s)e[o]=d;return e};const ze={data(){return{innerValue:1}},props:{modelValue:{type:Number},pageCount:{type:Number,required:!0},initialPage:{type:Number,default:1},forcePage:{type:Number},clickHandler:{type:Function,default:()=>{}},pageRange:{type:Number,default:3},marginPages:{type:Number,default:1},prevText:{type:String,default:"Prev"},nextText:{type:String,default:"Next"},breakViewText:{type:String,default:"…"},containerClass:{type:String,default:"pagination"},pageClass:{type:String,default:"page-item"},pageLinkClass:{type:String,default:"page-link"},prevClass:{type:String,default:"page-item"},prevLinkClass:{type:String,default:"page-link"},nextClass:{type:String,default:"page-item"},nextLinkClass:{type:String,default:"page-link"},breakViewClass:{type:String},breakViewLinkClass:{type:String},activeClass:{type:String,default:"active"},disabledClass:{type:String,default:"disabled"},noLiSurround:{type:Boolean,default:!1},firstLastButton:{type:Boolean,default:!1},firstButtonText:{type:String,default:"First"},lastButtonText:{type:String,default:"Last"},hidePrevNext:{type:Boolean,default:!1}},computed:{selected:{get:function(){return this.modelValue||this.innerValue},set:function(l){this.innerValue=l}},pages:function(){let l={};if(this.pageCount<=this.pageRange)for(let s=0;s<this.pageCount;s++){let e={index:s,content:s+1,selected:s===this.selected-1};l[s]=e}else{const s=Math.floor(this.pageRange/2);let e=t=>{let g={index:t,content:t+1,selected:t===this.selected-1};l[t]=g},o=t=>{let g={disabled:!0,breakView:!0};l[t]=g};for(let t=0;t<this.marginPages;t++)e(t);let d=0;this.selected-s>0&&(d=this.selected-1-s);let a=d+this.pageRange-1;a>=this.pageCount&&(a=this.pageCount-1,d=a-this.pageRange+1);for(let t=d;t<=a&&t<=this.pageCount-1;t++)e(t);d>this.marginPages&&o(d-1),a+1<this.pageCount-this.marginPages&&o(a+1);for(let t=this.pageCount-1;t>=this.pageCount-this.marginPages;t--)e(t)}return l}},methods:{handlePageSelected(l){this.selected!==l&&(this.innerValue=l,this.$emit("update:modelValue",l),this.clickHandler(l))},prevPage(){this.selected<=1||this.handlePageSelected(this.selected-1)},nextPage(){this.selected>=this.pageCount||this.handlePageSelected(this.selected+1)},firstPageSelected(){return this.selected===1},lastPageSelected(){return this.selected===this.pageCount||this.pageCount===0},selectFirstPage(){this.selected<=1||this.handlePageSelected(1)},selectLastPage(){this.selected>=this.pageCount||this.handlePageSelected(this.pageCount)}},beforeMount(){this.innerValue=this.initialPage},beforeUpdate(){this.forcePage!==void 0&&this.forcePage!==this.selected&&(this.selected=this.forcePage)}},Ee=["tabindex","innerHTML"],Ge=["tabindex","innerHTML"],Oe=["onClick","onKeyup"],Qe=["tabindex","innerHTML"],Je=["tabindex","innerHTML"],We=["innerHTML"],Xe=["innerHTML"],Ye=["onClick","onKeyup"],Ze=["innerHTML"],$e=["innerHTML"];function et(l,s,e,o,d,a){return e.noLiSurround?(i(),r("div",{key:1,class:u(e.containerClass)},[e.firstLastButton?(i(),r("a",{key:0,onClick:s[8]||(s[8]=t=>a.selectFirstPage()),onKeyup:s[9]||(s[9]=k(t=>a.selectFirstPage(),["enter"])),class:u([e.pageLinkClass,a.firstPageSelected()?e.disabledClass:""]),tabindex:"0",innerHTML:e.firstButtonText},null,42,We)):f("",!0),a.firstPageSelected()&&e.hidePrevNext?f("",!0):(i(),r("a",{key:1,onClick:s[10]||(s[10]=t=>a.prevPage()),onKeyup:s[11]||(s[11]=k(t=>a.prevPage(),["enter"])),class:u([e.prevLinkClass,a.firstPageSelected()?e.disabledClass:""]),tabindex:"0",innerHTML:e.prevText},null,42,Xe)),(i(!0),r(S,null,V(a.pages,t=>(i(),r(S,null,[t.breakView?(i(),r("a",{key:t.index,class:u([e.pageLinkClass,e.breakViewLinkClass,t.disabled?e.disabledClass:""]),tabindex:"0"},[E(l.$slots,"breakViewContent",{},()=>[N(m(e.breakViewText),1)])],2)):t.disabled?(i(),r("a",{key:t.index,class:u([e.pageLinkClass,t.selected?e.activeClass:"",e.disabledClass]),tabindex:"0"},m(t.content),3)):(i(),r("a",{key:t.index,onClick:g=>a.handlePageSelected(t.index+1),onKeyup:k(g=>a.handlePageSelected(t.index+1),["enter"]),class:u([e.pageLinkClass,t.selected?e.activeClass:""]),tabindex:"0"},m(t.content),43,Ye))],64))),256)),a.lastPageSelected()&&e.hidePrevNext?f("",!0):(i(),r("a",{key:2,onClick:s[12]||(s[12]=t=>a.nextPage()),onKeyup:s[13]||(s[13]=k(t=>a.nextPage(),["enter"])),class:u([e.nextLinkClass,a.lastPageSelected()?e.disabledClass:""]),tabindex:"0",innerHTML:e.nextText},null,42,Ze)),e.firstLastButton?(i(),r("a",{key:3,onClick:s[14]||(s[14]=t=>a.selectLastPage()),onKeyup:s[15]||(s[15]=k(t=>a.selectLastPage(),["enter"])),class:u([e.pageLinkClass,a.lastPageSelected()?e.disabledClass:""]),tabindex:"0",innerHTML:e.lastButtonText},null,42,$e)):f("",!0)],2)):(i(),r("ul",{key:0,class:u(e.containerClass)},[e.firstLastButton?(i(),r("li",{key:0,class:u([e.pageClass,a.firstPageSelected()?e.disabledClass:""])},[n("a",{onClick:s[0]||(s[0]=t=>a.selectFirstPage()),onKeyup:s[1]||(s[1]=k(t=>a.selectFirstPage(),["enter"])),class:u(e.pageLinkClass),tabindex:a.firstPageSelected()?-1:0,innerHTML:e.firstButtonText},null,42,Ee)],2)):f("",!0),a.firstPageSelected()&&e.hidePrevNext?f("",!0):(i(),r("li",{key:1,class:u([e.prevClass,a.firstPageSelected()?e.disabledClass:""])},[n("a",{onClick:s[2]||(s[2]=t=>a.prevPage()),onKeyup:s[3]||(s[3]=k(t=>a.prevPage(),["enter"])),class:u(e.prevLinkClass),tabindex:a.firstPageSelected()?-1:0,innerHTML:e.prevText},null,42,Ge)],2)),(i(!0),r(S,null,V(a.pages,t=>(i(),r("li",{key:t.index,class:u([e.pageClass,t.selected?e.activeClass:"",t.disabled?e.disabledClass:"",t.breakView?e.breakViewClass:""])},[t.breakView?(i(),r("a",{key:0,class:u([e.pageLinkClass,e.breakViewLinkClass]),tabindex:"0"},[E(l.$slots,"breakViewContent",{},()=>[N(m(e.breakViewText),1)])],2)):t.disabled?(i(),r("a",{key:1,class:u(e.pageLinkClass),tabindex:"0"},m(t.content),3)):(i(),r("a",{key:2,onClick:g=>a.handlePageSelected(t.index+1),onKeyup:k(g=>a.handlePageSelected(t.index+1),["enter"]),class:u(e.pageLinkClass),tabindex:"0"},m(t.content),43,Oe))],2))),128)),a.lastPageSelected()&&e.hidePrevNext?f("",!0):(i(),r("li",{key:2,class:u([e.nextClass,a.lastPageSelected()?e.disabledClass:""])},[n("a",{onClick:s[4]||(s[4]=t=>a.nextPage()),onKeyup:s[5]||(s[5]=k(t=>a.nextPage(),["enter"])),class:u(e.nextLinkClass),tabindex:a.lastPageSelected()?-1:0,innerHTML:e.nextText},null,42,Qe)],2)),e.firstLastButton?(i(),r("li",{key:3,class:u([e.pageClass,a.lastPageSelected()?e.disabledClass:""])},[n("a",{onClick:s[6]||(s[6]=t=>a.selectLastPage()),onKeyup:s[7]||(s[7]=k(t=>a.selectLastPage(),["enter"])),class:u(e.pageLinkClass),tabindex:a.lastPageSelected()?-1:0,innerHTML:e.lastButtonText},null,42,Je)],2)):f("",!0)],2))}var Q=je(ze,[["render",et]]);const tt=X({id:"filter-store",state:()=>({currentPage:1,filteredPage:1,filtersList:{name:"",status:"",gender:""}}),getters:{getFiltersList:l=>l.filtersList,getPage:l=>l.currentPage,getFilteredPage:l=>l.filteredPage},actions:{changeStoredFilters(l){this.filtersList.name=l.name,this.filtersList.status=l.status,this.filtersList.gender=l.gender},changeStoredPage(l){this.currentPage=l},changeStoredFilteredPage(l){this.filteredPage=l}}}),st=X("global-store",()=>{const l=ie();return{charactersNames:null,currentRoute:L(l.query.page)}}),at={class:"content container"},nt={class:"content__top"},lt={class:"content__row"},it=n("h1",{class:"content__title"},"Каталог",-1),rt={class:"content__info"},ot={key:2,class:"loader"},ut=n("img",{src:fe,alt:""},null,-1),dt=[ut],ct={key:3,class:"error-loader"},gt={key:4,class:"content__catalog"},_t={class:""},ft={class:"catalog"},ht={class:"catalog__list"},mt={class:"catalog__item"},vt=["src","srcset"],kt={class:"catalog__title"},yt={class:"catalog__price"},Pt=J({__name:"index",async setup(l){let s,e;const o=re(),d=oe(),a=tt(),{changeStoredFilters:t,changeStoredPage:g,changeStoredFilteredPage:P}=a,{getFiltersList:y,getPage:v,getFilteredPage:h}=ue(a),A=st();let{charactersNames:T}=A;const B=L(null);let C=L();const F=L(!1),M=L([]),Y=c=>{t({name:c.name,status:c.status,gender:c.gender}),P(1),d.push({query:{name:y.value.name,status:y.value.status,gender:y.value.gender,page:1}})},Z=()=>{t({name:"",status:"",gender:""}),P(1),d.push({query:{page:v.value}})},$=c=>{c.length<1?M.value=[]:M.value=T==null?void 0:T.filter(b=>b.includes(c))},H=async c=>{F.value=!0,await ge(c).then(b=>{b.info&&(B.value=null,C.value=b),F.value=!1})},I=w(()=>{let c="?";for(const[b,x]of Object.entries(o.query))c+=`&${b}=${x}`;return c}),q=w(()=>!!(o.query.name||o.query.status)),ee=w(()=>C.value?C.value.results:null),U=w(()=>C.value?C.value.info:null),D=w(()=>C.value?C.value.info.pages:0),te=c=>{g(c),d.push({query:{page:v.value}})},se=c=>{P(c),d.push({query:{page:h.value,name:y.value.name,status:y.value.status}})};return W(()=>o.query,async c=>{q.value?P(Number(o.query.page)):g(Number(o.query.page)),H(I.value)}),o.query.page?(g(Number(o.query.page)),H(I.value)):(g(1),H(`?page=${v.value}`)),T||([s,e]=de(()=>_e().then(c=>{T=c.results.map(x=>x.name.toLowerCase())})),await s,e()),(c,b)=>{const x=ce,ae=De;return i(),r("main",at,[n("div",nt,[n("div",lt,[it,n("span",rt,m(_(U)?_(U).count:0)+" персонажа ",1)])]),_(q)?(i(),G(_(Q),{key:0,"page-count":_(D),"click-handler":se,"prev-text":"<-","next-text":"->","page-range":7,"container-class":"catalog__pagination pagination","page-link-class":"pagination__link","page-class":"pagination__item","active-class":"pagination__link--current","disabled-class":"pagination__link--disabled","first-last-button":!0},null,8,["page-count"])):f("",!0),_(q)?f("",!0):(i(),G(_(Q),{key:1,"page-count":_(D),"click-handler":te,"prev-text":"<-","next-text":"->","page-range":7,"container-class":"catalog__pagination pagination","page-link-class":"pagination__link","page-class":"pagination__item","active-class":"pagination__link--current","disabled-class":"pagination__link--disabled","first-last-button":!0},null,8,["page-count"])),_(F)?(i(),r("div",ot,dt)):f("",!0),_(B)?(i(),r("div",ct,[N(m(_(B))+" ",1),K(x,{to:"/",class:"button button--primary mainpage__link"},{default:O(()=>[N(" На главную ")]),_:1})])):(i(),r("div",gt,[n("aside",_t,[K(ae,{onLoadFilteredCharacters:Y,onClearFilters:Z,onFilterByName:$,helpers:_(M)},null,8,["helpers"])]),n("section",ft,[n("ul",ht,[(i(!0),r(S,null,V(_(ee),p=>(i(),r("li",mt,[K(x,{to:"/products/"+p.id,class:"catalog__pic"},{default:O(()=>[n("img",{src:p.image,srcset:p.image,alt:"Изображение персонажа"},null,8,vt)]),_:2},1032,["to"]),n("h3",kt,m(p.name),1),n("span",yt,m(p.status),1)]))),256))])])]))])}}});export{Pt as default};
